<?php defined('_FINDEX_') or die('Access Denied'); //functionfunction TotalSks($id,$kode,$konsentrasi,$kur){$prodi=($kode=='61101') ? 42:41;$T11 = "0";if($konsentrasi=='41'){$sql="SELECT t1.*,t2.Nama AS NamaSMk,t3.Nama AS NamaJMK FROM matakuliah t1 left join statusmtk t2 ON t1.StatusMtk_ID = t2.StatusMtk_ID, jenismk t3 WHERE t1.JenisMTK_ID=t3.JenisMK_ID AND t1.Identitas_ID='$id' AND t1.Jurusan_ID='$kode' AND t1.Aktif='Y' AND t1.Kurikulum_ID IN ('41') AND t1.StatusMtk_ID='A' AND t1.JenisKurikulum_ID='$kur' GROUP BY t1.Matakuliah_ID ORDER BY t1.Matakuliah_ID,t1.Kode_mtk,t1.Semester";	$qry= _query($sql) or die ();	while ($r=_fetch_array($qry)){ 		$T11=$T11+$r['SKS'];	}}elseif($konsentrasi=='40'){$sql="SELECT t1.*,t2.Nama AS NamaSMk,t3.Nama AS NamaJMK FROM matakuliah t1 left join statusmtk t2 ON t1.StatusMtk_ID = t2.StatusMtk_ID, jenismk t3 WHERE t1.JenisMTK_ID=t3.JenisMK_ID AND t1.Identitas_ID='$id' AND t1.Jurusan_ID='$kode' AND t1.Aktif='Y' AND t1.Kurikulum_ID IN ($konsentrasi) AND t1.StatusMtk_ID='A' AND t1.JenisMTK_ID!='B'AND t1.JenisKurikulum_ID='$kur' GROUP BY t1.Matakuliah_ID ORDER BY t1.Matakuliah_ID,t1.Kode_mtk,t1.Semester";	$qry= _query($sql) or die ();	while ($r=_fetch_array($qry)){ 	$T11=$T11+$r[SKS];	}}else{$sql="SELECT t1.*,t2.Nama AS NamaSMk,t3.Nama AS NamaJMK FROM matakuliah t1 left join statusmtk t2 ON t1.StatusMtk_ID = t2.StatusMtk_ID, jenismk t3 WHERE t1.JenisMTK_ID=t3.JenisMK_ID AND t1.Identitas_ID='$id' AND t1.Jurusan_ID='$kode' AND t1.Aktif='Y' AND t1.Kurikulum_ID IN ($prodi,$konsentrasi) AND t1.StatusMtk_ID='A' AND t1.JenisKurikulum_ID='$kur' GROUP BY t1.Matakuliah_ID ORDER BY t1.Matakuliah_ID,t1.Kode_mtk,t1.Semester";	$qry= _query($sql) or die ();	while($r=_fetch_array($qry)){ 		$T11=$T11+$r[SKS];	}}return $T11;}function MatakuliahPerSemester($semester,$id,$kode,$kons,$kur){$prodi=($kode=='61101') ? 42:41;echo"<div class='row-fluid'><div class='panel'>	<div class='widget-header'><h3><i class='icon-sign-blank'></i> SEMESTER $semester</h3></div>	<table class='table table-bordered table-striped responsive'><thead>		<tr>			<th width='5%'>NO</th>			<th width='5%'>ID</th>			<th width='10%'><center>KODE MTK</center></th>			<th>NAMA MATAKULIAH</th>			<th width='5%'><center>GBPP</center></th>			<th width='5%'><center>SAP</center></th>			<th width='5%'><center>SKS</center></th>			<th width='5%'><center>STATUS</center></th>		</tr>		</thead>                        		<tbody>";if($kons=='41'){$sql="SELECT t1.*,t2.Nama AS NamaSMk,t3.Nama AS NamaJMK FROM matakuliah t1 left join statusmtk t2 ON t1.StatusMtk_ID = t2.StatusMtk_ID, jenismk t3 WHERE t1.JenisMTK_ID=t3.JenisMK_ID AND t1.Identitas_ID='$id' AND t1.Jurusan_ID='$kode' AND t1.Semester LIKE '%$semester%' AND t1.Kurikulum_ID IN ('41') AND t1.Aktif='Y' AND t1.StatusMtk_ID='A' AND t1.JenisKurikulum_ID='$kur' GROUP BY t1.Matakuliah_ID ORDER BY t1.Kode_mtk,t1.Semester";}elseif($kons=='40'){$sql="SELECT t1.*,t2.Nama AS NamaSMk,t3.Nama AS NamaJMK FROM matakuliah t1 left join statusmtk t2 ON t1.StatusMtk_ID = t2.StatusMtk_ID, jenismk t3 WHERE t1.JenisMTK_ID=t3.JenisMK_ID AND t1.Identitas_ID='$id' AND t1.Jurusan_ID='$kode' AND t1.Semester LIKE '%$semester%' AND t1.Kurikulum_ID IN ($kons) AND t1.Aktif='Y' AND t1.StatusMtk_ID='A' AND t1.JenisKurikulum_ID='$kur' GROUP BY t1.Matakuliah_ID ORDER BY t1.Kode_mtk,t1.Semester";} else {$sql="SELECT t1.*,t2.Nama AS NamaSMk,t3.Nama AS NamaJMK FROM matakuliah t1 left join statusmtk t2 ON t1.StatusMtk_ID = t2.StatusMtk_ID, jenismk t3 WHERE t1.JenisMTK_ID=t3.JenisMK_ID AND t1.Identitas_ID='$id' AND t1.Jurusan_ID='$kode' AND t1.Semester LIKE '%$semester%' AND t1.Kurikulum_ID IN ($prodi,$kons) AND t1.Aktif='Y' AND t1.StatusMtk_ID='A'  AND t1.JenisKurikulum_ID='$kur' GROUP BY t1.Matakuliah_ID ORDER BY t1.Kode_mtk,t1.Semester";}		$qry= _query($sql) or die ();	while ($r=_fetch_array($qry)){ 	$mtkPilihan=($r['JenisMTK_ID']=='B' )? "<i>  ( Matakuliah Pilihan )</i>":"";	$sttus = ($r['Aktif'] == 'Y')? '<i class="icon-ok green"></i>' : '<i class="icon-remove red"></i>';	$KelompokMtk=KelompokMtk($r[KelompokMtk_ID]);	$NamaMtk=strtoupper($r['Nama_matakuliah']);	$n11++;	echo "<tr>                            		<td>$n11</td>		<td>$r[Matakuliah_ID]</td>		<td>$KelompokMtk <span class='pull-right'>$r[Kode_mtk]</span></td>		<td><a class='ui-lightbox' href='get-detail-Mtk-$r[Matakuliah_ID].html?lightbox[iframe]=true&ui-lightbox[width]=75p&ui-lightbox[height]=75p'>$NamaMtk</a> $mtkPilihan</td>  		<td><center><a class='btn btn-mini ui-lightbox' href='get-detail-Gbpp-$r[Matakuliah_ID].html?lightbox[iframe]=true&ui-lightbox[width]=75p&ui-lightbox[height]=75p'>GBPP</a></center></td>		<td><center><a class='btn btn-mini ui-lightbox' href='get-detail-Sap-$r[Matakuliah_ID].html?lightbox[iframe]=true&ui-lightbox[width]=75p&ui-lightbox[height]=75p'>SAP</a></center></td>    		<td><center>$r[SKS]</center></td><td><center>$sttus</center></td>";	$T11=$T11+$r[SKS];	$jt11=number_format($T11,0,',','.');	$jumlah11="<span class='badge badge-info'>$jt11</span>";	echo "</tr>";        	}    echo "<tfoot>			<tr>                            				<td colspan=6 ><b class='pull-right'>Total :</b></td>				<td><center>$jumlah11</center></td>				<td><b> SKS</b></td>			</tr>		</tfoot>";	echo "</tbody></table></div></div>";}//Startif($baca){ $id      	= $_SESSION['Identitas'];$jabatan 	= $_SESSION['Jabatan'];$kode		= ($jabatan==18 OR $jabatan==19)? $_SESSION['prodi']: $_POST['jurusan'];$diasbeld	= ($jabatan==18 OR $jabatan==19)? 'disabled' : '';$diasbelt	= ($jabatan==19)? 'disabled' : '';$kr=_query("SELECT JenisKurikulum_ID FROM jeniskurikulum WHERE Jurusan_ID='$kode' AND Aktif='Y'")or die();$krl=_fetch_array($kr);$kurikulum = (empty($_POST['kuriklm']))? $krl['JenisKurikulum_ID']: $_POST['kuriklm'];if($jabatan==19){$m = GetFields('mahasiswa', 'NIM', $_SESSION['yapane'], 'Kurikulum_ID');$konsentrasi = $m['Kurikulum_ID'];}else{$konsentrasi = (empty($_POST['konsentrasi']))? '': $_POST['konsentrasi'];}$PRODI=NamaProdi($kode);$NamaKonsentrasi=strtoupper(GetName("kurikulum","Kurikulum_ID",$konsentrasi,"Nama"));$pilihAll=($hapus)? "<input type='checkbox' id='checkall'>":"No";$AksiEdit=($edit)? "<th></th>":"";?><div class="row"><div class="span12"><form method="post" id="form">	<div class="widget widget-table">		<div class="widget-header">									<h3><i class="icon-hand-up"></i>DAFTAR MATAKULIAH</h3>			<div class="widget-actions">				<div class="btn-group">				<?php 				if(!empty($konsentrasi) AND !empty($kode)){					echo"<a href='do-print-Matakuliah-$konsentrasi-$kode-$kurikulum.html?lightbox[iframe]=true&ui-lightbox[width]=75p&ui-lightbox[height]=75p' class='btn btn-small btn-primary ui-lightbox'><i class='icon-print'></i>Print</a>";					}				if($baca AND $buat AND $edit){					echo"<button class='btn btn-small dropdown-toggle' data-toggle='dropdown'>Menu&nbsp;&nbsp;<span class='caret'></span></button>						<ul class='dropdown-menu'>							<li><a href='aksi-matakuliah-all.html'>Manajemen Matakuliah</a></li>							<li><a href='aksi-matakuliah-kurikulum.html'>Manajemen Kurikulum</a></li>							<li><a href='aksi-matakuliah-konsentrasi.html'>Manajemen Konsentrasi</a></li>							<li class='divider'></li>							<li><a href='aksi-matakuliah-KodeMtk.html'>Kelompok Matakuliah</a></li>						</ul>";				}				?>					</div>			</div> 		</div> <div class="widget-toolbar"><div class="row-fluid"><div class="pull-left"  style="padding-top: 7px"><?php echo"<select name='jurusan' onChange='this.form.submit()' $diasbeld>		<option value=''> -- Pilih Program Studi --</option>";		$sqlp="SELECT * FROM jurusan WHERE Identitas_ID='$id'";		$qryp=_query($sqlp)or die();		while ($d1=_fetch_array($qryp)){			if ($d1['kode_jurusan']==$kode){ $cek="selected";  }  else{ $cek=""; }			echo "<option value='$d1[kode_jurusan]' $cek>$d1[nama_jurusan]</option>";		}		echo"</select> 		<select name='kuriklm' onChange='this.form.submit()'>		<option value=''> -- Pilih Kurikulum --</option>";		$sqlp="SELECT * FROM jeniskurikulum WHERE Jurusan_ID='$kode' ORDER BY JenisKurikulum_ID DESC";		$qryp=_query($sqlp)or die();		while ($k=_fetch_array($qryp)){			if ($k['JenisKurikulum_ID']==$kurikulum){ $cek="selected";  }  else{ $cek="";}			echo "<option value='$k[JenisKurikulum_ID]' $cek>$k[Nama]</option>";		}	echo"</select>						<select name='konsentrasi' onChange='this.form.submit()' $diasbelt>						<option value=''> -- Pilih Konsentrasi --</option>";							$sqlp="SELECT * FROM kurikulum WHERE Identitas_ID='$id' AND Jurusan_ID='$kode'";							$qryp=_query($sqlp)or die();							while ($k=_fetch_array($qryp)){							if ($k['Kurikulum_ID']==$konsentrasi){ $cek="selected";  }  else{ $cek="";}							echo "<option value='$k[Kurikulum_ID]' $cek>$k[Nama]</option>";							}						echo"</select>";?></div><div class="pull-right">	<ul class="breadcrumb" style="margin-bottom: 0">		<li> PROGRAM STUDI <span class="divider">/</span></li>		<li class="active"><?php echo $PRODI; ?> <span class="divider">/</span></li>		<li class="active"> <?php echo $NamaKonsentrasi; ?></li>	</ul></div></div></div><div class="widget-content"><?phpecho $id.'-'.$kode.'-'.$konsentrasi.'-'.$kurikulum;if (!empty($konsentrasi) AND !empty ($kode)) {$jumlahsemester= ($kode=='61101')? '4': '8';for ($num = 1; $num <= $jumlahsemester; $num++){MatakuliahPerSemester($num,$id,$kode,$konsentrasi,$kurikulum);}	$Ttot=TotalSks($id,$kode,$konsentrasi,$kurikulum);	$jumlasemua="<span class='badge badge-success'>$Ttot</span><b> SKS</b>";	echo"</div>			<div class='widget-toolbar'>				<center><i class='icon-tasks'></i> TOTAL SELURUHNYA : $jumlasemua</center>			</div> ";  }else{  echo "<div class=''>		<center><br><br>				<h2>Daftar Matakuliah</h2>				<div class='error-details'>				 Untuk Mellihat Matakuliah, Silahkan Pilih Menu Pilihan <strong></strong> di atas.				</div> 				<br>				<br>		</center>		</div>";}?></div></form></div></div><?php }else{ErrorAkses();} ?>