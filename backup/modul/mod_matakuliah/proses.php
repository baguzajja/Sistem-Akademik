<?phpdefined('_FINDEX_') or die('Access Denied');//Tambah dan Edit Matakuliahif(isset($_POST['simpanMatakuliah'])) {$md 			= $_POST['md']+0;	$kode			= $_POST['i'];	$jur			= $_POST['jur'];	$nkur			= $_POST['nkur'];if ($md == 0) {	$update=_query("UPDATE matakuliah SET Identitas_ID  = '$kode',		Kode_mtk  			= '$_POST[kmk]',		Nama_matakuliah  	= '$_POST[nm]',		Semester  			= '$_POST[sesi]',		SKS  				= '$_POST[sks]',		Jurusan_ID  		= '$jur',		KelompokMtk_ID  	= '$_POST[klmptk]',		JenisMTK_ID  		= '$_POST[jmk]',		JenisKurikulum_ID  	= '$_POST[jkur]',		StatusMtk_ID  		= '$_POST[stmk]',		Kurikulum_ID 		= '$nkur',		Penanggungjawab  	= '$_POST[pj]',		gbpp  				= '$_POST[gbpp]',		sap  				= '$_POST[sap]',		Aktif  				= '$_POST[ak]'		WHERE Matakuliah_ID = '$_POST[ID]'");	alert('info','Matakuliah Berhasil di Update');	CatatLog($_SESSION[Nama],'Update Matakuliah','Matakuliah Berhasil di Update');		htmlRedirect('aksi-matakuliah-all.html',1); 	}else{		$cek=_num_rows(_query("SELECT * FROM matakuliah WHERE Kode_mtk='$_POST[kmk]' AND Jurusan_ID='$jur' AND Nama_matakuliah='$_POST[nm]' AND Kurikulum_ID='$nkur' AND JenisKurikulum_ID='$_POST[jkur]'"));       if ($cek > 0){		alert('error','Gagal... !! Data matakuliah Sudah ada dalam database');		CatatLog($_SESSION[Nama],'Tambah Matakuliah','Gagal... !! Data matakuliah Sudah ada dalam database');			}else{                $masuk=_query("INSERT INTO matakuliah(Identitas_ID,Kode_mtk,Nama_matakuliah,Semester,SKS,Jurusan_ID,KelompokMtk_ID,JenisMTK_ID,JenisKurikulum_ID,StatusMtk_ID,Kurikulum_ID,Penanggungjawab,gbpp,sap,Aktif)        VALUES('$kode','$_POST[kmk]','$_POST[nm]','$_POST[sesi]','$_POST[sks]','$jur','$_POST[klmptk]','$_POST[jmk]','$_POST[jkur]','$_POST[stmk]','$nkur','$_POST[pj]','$_POST[gbpp]','$_POST[sap]','$_POST[ak]')");		alert('info','Matakuliah Berhasil Di Simpan');		CatatLog($_SESSION[Nama],'Tambah Matakuliah','Matakuliah Berhasil di Simpan');			htmlRedirect('aksi-matakuliah-all.html',1);  		}	}}//Tambah dan Edit Konsentrasiif(isset($_POST['simpanKonsentrasi'])) {	$md				= $_POST['md']+0;	$id				= $_POST['id'];	$identitas 		= $_POST['identitas']; 	$jurusan		= $_POST['jurusan'];   	$kode			= $_POST['Kode'];        	$nama		 	= $_POST['Nama'];	$Sesi		 	= $_POST['Sesi'];	$JmlSesi		= $_POST['JmlSesi'];	$aktif 			= $_POST['Aktif'];if ($md == 0) {	$update=_query("UPDATE kurikulum SET			Kode			= '$kode',			Nama			= '$nama',			Identitas_ID	= '$identitas',			Jurusan_ID		= '$jurusan',			Sesi			= '$Sesi',			JmlSesi			= '$JmlSesi',			Aktif			= '$aktif'			WHERE Kurikulum_ID	= '$id'");	alert('info','Konsentrasi Berhasil di Update');	CatatLog($_SESSION[Nama],'Update Konsentrasi','Konsentrasi Berhasil di Update');		htmlRedirect('aksi-matakuliah-konsentrasi.html',1); }else{	$cek=_num_rows(_query("SELECT * FROM kurikulum WHERE Kode='$kode' AND Identitas_ID='$identitas' AND Jurusan_ID='$jurusan'"));	if ($cek > 0){		alert('error','Konsentrasi Gagal disimpan...Konsentrasi Sudah ada dalam database');		CatatLog($_SESSION[Nama],'Tambah Data Konsentrasi','Konsentrasi Gagal disimpan.Sudah ada dalam database');	}else{       $insert= _query("INSERT INTO kurikulum(Kode,Nama,Identitas_ID,Jurusan_ID,Sesi,JmlSesi,Aktif)        VALUES('$kode','$nama','$identitas','$jurusan','$Sesi','$JmlSesi','$aktif')");		alert('info','Konsentrasi Berhasil di Simpan');		CatatLog($_SESSION[Nama],'Tambah Konsentrasi','Konsentrasi Berhasil di Simpan');			htmlRedirect('aksi-matakuliah-konsentrasi.html',1); 		}	}	}//Tambah dan Edit Kurikulumif(isset($_POST['simpanKurikulum'])) {	$md 			= $_POST['md']+0;	$id				= $_POST['id'];	$jurusan		= $_POST['jurusan'];         	$nama		 	= $_POST['nama'];	$aktif 			= $_POST['Aktif'];if ($md == 0) {	$update=_query("UPDATE jeniskurikulum SET			Nama			= '$nama',			Jurusan_ID		= '$jurusan',			Aktif			= '$aktif'			WHERE JenisKurikulum_ID	= '$id'");if ($aktif == 'Y') {	$updateAll=_query("UPDATE jeniskurikulum SET Aktif = 'N' WHERE Jurusan_ID='$jurusan' AND JenisKurikulum_ID NOT IN ('$id')");}	alert('info','Kurikulum Berhasil di Update');	CatatLog($_SESSION[Nama],'Update Kurikulum','Kurikulum Berhasil di Update');		htmlRedirect('aksi-matakuliah-kurikulum.html',1); }else{	$cek=_num_rows(_query("SELECT * FROM jeniskurikulum WHERE Nama='$nama' AND Jurusan_ID='$jurusan'"));        if ($cek > 0){	alert('error','Kurikulum Gagal disimpan...Kurikulum Sudah ada dalam database');	CatatLog($_SESSION[Nama],'Tambah Data Kurikulum','Kurikulum Gagal disimpan.Sudah ada dalam database');	}else{       $insert= _query("INSERT INTO jeniskurikulum(Nama,Jurusan_ID,Aktif)        VALUES('$nama','$jurusan','$aktif')");		$idBaru = mysql_insert_id();if ($aktif == 'Y') {	$updateAll=_query("UPDATE jeniskurikulum SET Aktif = 'N' WHERE Jurusan_ID='$jurusan' AND JenisKurikulum_ID NOT IN ('$idBaru')");	}	alert('info','Kurikulum Berhasil di Simpan');	CatatLog($_SESSION[Nama],'Tambah Kurikulum','Kurikulum Berhasil di Simpan');		htmlRedirect('aksi-matakuliah-kurikulum.html',1); 	}}}//Tambah dan Edit Kode Mtkif(isset($_POST['simpanKodeMtk'])) {	$md 			= $_POST['md']+0;	$id				= $_POST['Kode'];        	$nama		 	= $_POST['Nama'];	$aktif 			= $_POST['Aktif'];if ($md == 0) {	$update=_query("UPDATE kelompokmtk SET			Nama			= '$nama',			Aktif			= '$aktif'			WHERE KelompokMtk_ID = '$id'");	alert('info','KODE MTK Berhasil di Update');	CatatLog($_SESSION[Nama],'Update KODE MTK','KODE MTK Berhasil di Update');		htmlRedirect('aksi-matakuliah-KodeMtk.html',1); }else{	$cek=_num_rows(_query("SELECT * FROM kelompokmtk WHERE Nama='$nama' AND KelompokMtk_ID='$id'"));        if ($cek > 0){	alert('error','KODE MTK Gagal disimpan...KODE MTK Sudah ada dalam database');	CatatLog($_SESSION[Nama],'Tambah Data KODE MTK','KODE MTK Gagal disimpan.Sudah ada dalam database');	}else{       $insert= _query("INSERT INTO kelompokmtk(KelompokMtk_ID,Nama,Aktif)        VALUES('$id','$nama','$aktif')");	alert('info','KODE MTK  Berhasil di Simpan');	CatatLog($_SESSION[Nama],'Tambah KODE MTK ','KODE MTK  Berhasil di Simpan');		htmlRedirect('aksi-matakuliah-KodeMtk.html',1); 	}}}// Hapus Matakuliahif(isset($_POST['deleteMtk'])){	$source = @$_POST['check'];	$source = multipleSelect($source);	if(empty($source)){	alert('error','Pilih Matakuliah yang Akan di Hapus');	CatatLog($_SESSION[Nama],'Hapus Data Matakuliah','Gagal Meng-Hapus Matakuliah Belum Dipilih');	}else{	$del = explode(",",$source);	foreach($del as $id)	{        //Hapus jadwal         $tabeljadwal="jadwal";		$kondisijadwal="Kode_Mtk='$id'";		$deletejadwal = delete($tabeljadwal,$kondisijadwal);                //Hapus Krs         $tabelkrs="krs";		$kondisikrs="Jadwal_ID='$id'";		$deletekrs = delete($tabelkrs,$kondisikrs);                //Hapus matakuliah 		$tabel="matakuliah";		$kondisi="Matakuliah_ID='$id'";		$delete = delete($tabel,$kondisi);		}	alert('info','Matakuliah Berhasil di Hapus');	CatatLog($_SESSION[Nama],'Hapus Data Matakuliah','Matakuliah Berhasil di Hapus');	}}// Hapus Konsentrasiif(isset($_POST['deleteKons'])){	$source = @$_POST['check'];	$source = multipleSelect($source);	if(empty($source)){	alert('error','Pilih Konsentrasi yang Akan di Hapus');	CatatLog($_SESSION[Nama],'Hapus Data Konsentrasi','Gagal Meng-Hapus Konsentrasi Belum Dipilih');	}else{	$del = explode(",",$source);	foreach($del as $id)	{		$cek=_num_rows(_query("SELECT * FROM matakuliah WHERE Kurikulum_ID='$id' AND Aktif='Y'"));        if ($cek > 0){		$hapus= false;		}else{		$hapus= true;		$tabel="kurikulum";		$kondisi="Kurikulum_ID='$id'";		$delete = delete($tabel,$kondisi);			}	}		if($hapus){		alert('info','Konsentrasi Berhasil di Hapus');		CatatLog($_SESSION[Nama],'Hapus Data Konsentrasi','Konsentrasi Berhasil di Hapus');		}else{		alert('error','Konsentrasi Tidak Bisa di Hapus. Masih Ada Matakuliah Aktif di Konsentrasi tersebut. Non-aktifkan Matakuliah terlebih dahulu, Atau Hapus Matakuliah di Konsentrasi yg akan di hapus');		CatatLog($_SESSION[Nama],'Hapus Data Konsentrasi','Konsentrasi Gagal di Hapus Masih Ada Matakuliah di Konsentrasi');		}	}}// Hapus Kurikulumif(isset($_POST['deleteKur'])){	$source = @$_POST['check'];	$source = multipleSelect($source);	if(empty($source)){	alert('error','Pilih Kurikulum yang Akan di Hapus');	CatatLog($_SESSION[Nama],'Hapus Data Kurikulum','Gagal Meng-Hapus Kurikulum Belum Dipilih');	}else{	$del = explode(",",$source);	foreach($del as $id)	{		$cek=_num_rows(_query("SELECT * FROM matakuliah WHERE JenisKurikulum_ID='$id' AND Aktif='Y'"));        if ($cek > 0){		$hapus= false;		}else{		$hapus= true;		$tabel="jeniskurikulum";		$kondisi="JenisKurikulum_ID='$id'";		$delete = delete($tabel,$kondisi);		}	}		if($hapus){		alert('info','Kurikulum Berhasil di Hapus');		CatatLog($_SESSION[Nama],'Hapus Data Kurikulum','Kurikulum Berhasil di Hapus');		}else{		alert('error','Kurikulum Tidak Bisa di Hapus. Masih Ada Matakuliah Aktif di Kurikulum tersebut. Non-aktifkan Matakuliah terlebih dahulu, Atau Hapus Matakuliah di kurikulum yg akan di hapus');		CatatLog($_SESSION[Nama],'Hapus Data Kurikulum','Kurikulum Gagal di Hapus Masih Ada Matakuliah di Kurikulum');		}	}}// Hapus Kode MTKif(isset($_POST['deleteKodMtk'])){	$source = @$_POST['check'];	$source = multipleSelect($source);	if(empty($source)){	alert('error','Pilih Kode MTK yang Akan di Hapus');	CatatLog($_SESSION[Nama],'Hapus Data Kode MTK','Gagal Meng-Hapus Kode MTK Belum Dipilih');	}else{	$del = explode(",",$source);	foreach($del as $id)	{		$cek=_num_rows(_query("SELECT * FROM matakuliah WHERE KelompokMtk_ID='$id' AND Aktif='Y'"));        if ($cek > 0){		$hapus= false;		}else{		$hapus= true;		$tabel="kelompokmtk";		$kondisi="KelompokMtk_ID='$id'";		$delete = delete($tabel,$kondisi);			}	}		if($hapus){		alert('info','Kode MTK Berhasil di Hapus');		CatatLog($_SESSION[Nama],'Hapus Data Kode MTK','Kode MTK Berhasil di Hapus');		}else{		alert('error','Kode MTK Tidak Bisa di Hapus. Masih Ada Matakuliah Aktif dengan Kode MTK tersebut. Non-aktifkan Matakuliah terlebih dahulu, Atau Hapus Matakuliah di Kode MTK yg akan di hapus');		CatatLog($_SESSION[Nama],'Hapus Data Kode MTK','Kode MTK Gagal di Hapus Masih Ada Matakuliah di Kode MTK');		}	}}